---
// 导航栏组件
import { getLangFromUrl, useTranslations, getLocalePath, getAlternateLocaleUrl } from '../i18n/utils';
import { languages } from '../i18n/ui';
import { SITE_TITLE_I18N } from '../consts';

interface Props {
	lang?: 'zh' | 'en';
}

const { lang: propLang } = Astro.props;
const lang = propLang || getLangFromUrl(Astro.url);
const t = useTranslations(lang);
const siteTitle = SITE_TITLE_I18N[lang];
const homePath = getLocalePath(lang, '/');
const aboutPath = getLocalePath(lang, '/about/');

// Generate URLs for each language
const langUrls = Object.fromEntries(
	Object.keys(languages).map(code => [code, getAlternateLocaleUrl(Astro.url, code as 'zh' | 'en')])
);

const otherLang = lang === 'zh' ? 'en' : 'zh';
const otherLangUrl = langUrls[otherLang];
const otherLangName = languages[otherLang];
const rssPath = lang === 'zh' ? '/rss.xml' : '/en/rss.xml';
---

<nav class="navigation">
	<div class="nav-container">
		<div class="nav-left">
			<span class="site-title">{siteTitle}</span>
		</div>
		<div class="nav-center">
			<a href={homePath} class="nav-link">{t('nav.home')}</a>
			<a href={aboutPath} class="nav-link">{t('nav.about')}</a>
		</div>
		<div class="nav-right">
			<a href="https://github.com/real-jiakai/mp-blog" class="nav-link" target="_blank">GitHub</a>
			<a href={rssPath} class="nav-link">RSS</a>
			<a href={otherLangUrl} class="nav-link">{otherLangName}</a>
		</div>
	</div>
</nav>

<style>
	.navigation {
		background: #c0c0c0;
		border-bottom: 2px solid #808080;
		padding: 8px 0;
		margin-bottom: 20px;
	}
	
	.nav-container {
		max-width: 800px;
		margin: 0 auto;
		padding: 0 20px;
		display: flex;
		justify-content: space-between;
		align-items: center;
	}
	
	.nav-left {
		flex: 1;
	}
	
	.nav-center {
		display: flex;
		gap: 20px;
	}
	
	.nav-right {
		display: flex;
		gap: 10px;
		flex: 1;
		justify-content: flex-end;
	}
	
	.site-title {
		font-size: 20px;
		font-weight: bold;
		color: #000000;
	}
	
	.nav-link {
		color: #000000;
		text-decoration: none;
		padding: 4px 12px;
		border: 1px outset #c0c0c0;
		background: #c0c0c0;
		display: inline-block;
		font-size: 16px;
	}
	
	.nav-link:hover {
		border: 1px inset #c0c0c0;
	}
	
	.nav-link.active {
		border: 1px inset #c0c0c0;
		background: #808080;
	}
</style>